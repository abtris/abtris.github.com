
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Pár tipů pro práci s formátem iCalendar - Prskavčí blog</title>
  <meta name="author" content="Ladislav Prskavec">

  
  <meta name="description" content="Dělám na PHP aplikaci, která kromě RSS generuje také iCalendar pro Lighting a iCal na Mac OS X. Někomu stačí asi RFC 2445 a hravě si s tím poradí, &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.prskavec.net/2008/05/pr-tipu-pro-prci-s-formtem-icalendar/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/all.css?v=1412111641" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/feed/index.html" rel="alternate" title="Prskavčí blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
<meta name="google-site-verification" content="mepQHhq6JPqzvIjErdB-A6hp3UKAYIlYHN7xPUL8JUM" />

  
</head>

<body   >
  <header role="banner"><hgroup>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/feed/index.html" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.prskavec.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archív</a></li>
  <li><a href="/prednasky">Přednášky</a></li>  
  <li><a href="/skoleni">Školení</a></li>
  <li><a href="/kontakt">Kontakt</a></li>  
</ul>

</nav> 
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Pár tipů pro práci s formátem iCalendar</h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-05-13T00:00:00+02:00" pubdate data-updated="true">13. 05. 2008</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Dělám na PHP aplikaci, která kromě RSS generuje také <a href="http://cs.wikipedia.org/wiki/ICalendar">iCalendar</a> pro Lighting a iCal na Mac OS X. Někomu stačí asi <a href="http://tools.ietf.org/html/rfc2445">RFC 2445</a> a hravě si s tím poradí, ale pro ty ostatní pár tipů, které mi pomohli a které mě trochu mátli. Ještě může bý napomocný <a href="http://www.kanzaki.com/docs/ical/">iCalendar Specification Excerpts</a>.  Data mám v mysql kde je datum a čas odděleně a pokud událost nemá čas (je <code>NULL</code>) tak je to celodenní událost. Pokud má jen čas od tak končí za nějakou stanovenou dobu třeba 90 min jako ve škole. Pokud má jen datum od tak je to jednodenní akce.  Pár zásad při tvorbě iCalendar exportu</p>

<ul>
    <li>jednotlivé tagy jsou velkými písmeny a na samostatných řádcích</li>
    <li>tagy jsou volitelné a je jich mnoho vyberte si ty které opravdu potřebujete</li>
    <li>datum se dá udávat několika způsoby:
<ul>
    <li><code>DTSTART;VALUE=DATE:YYYYMMDD</code> - jen datum asi nejednoduší forma</li>
    <li><code>DTSTART:YYYYMMDDTHHMMSS</code> - formát s časem v lokálním formátu</li>
    <li><code>DTSTART:YYYYMMDDTHHMMSSZ</code> - tady pozor Z na konci udává, že máte hodnoty v UTC (pokud ne vzniká čas posun)</li>
    <li><code>DTEND</code> je obdobně</li>
    <li><code>RRULE:FREQ=DAILY;UNTIL=YYYYMMDDTHHMMSS</code> - pro opakované události</li>
</ul>
</li>
    <li><code>URL</code> - nesmí obsahovat entity (nepodporuje Google Calendar)</li>
    <li><code>DESCRIPTION</code> - dlouhý popis</li>
    <li><code>SUMMARY</code> - nadpis</li>
    <li><code>LOCATION</code> - místo konání akce</li>
</ul>


<p>Formát si zkontrolujte <a href="http://severinghaus.org/projects/icv/">validátorem</a>, to nikdy neškodí.  Já potom zkouším genrovaný iCalendar v Lightingu, Windows Calendar a Google Calendar. iCal pro Mac OS X nemám snad to v něm bude fungovat také.  Pro správné zobrazení češtiny v Google calendar nezapomeňte hlavičku, ostatní si poradí i bez ní, nevím proč Google ne. <code>header(&ldquo;Content-Type: text/<a href="http://www.dadsplan.com/">calendar</a>; charset=utf-8&rdquo;); header(&ldquo;Content-Disposition: attachment; filename=calendar.ics&rdquo;);</code> Základní objekt iCalendar, který popisuje &ldquo;Den oslav dobytí Bastily&rdquo; jako událost konající se od 14. července 1997 17:00 (UTC) do 15. července 1997 03:59:59 (UTC)</p>

<pre>BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//hacksw/handcal//NONSGML v1.0//EN
BEGIN:VEVENT
DTSTART:19970714T170000Z
DTEND:19970715T035959Z
SUMMARY:Bastille Day Party
END:VEVENT
END:VCALENDAR</pre>


<h3>Update</h3>


<ul>
    <li>v SQL se hodí použít <code>SELECT DATE_FORMAT(datum,'%Y%m%d') as datum, TIME_FORMAT(cas,'%H%i%s') as cas, ...</code></li>
    <li>jako konce řádek je dobré napsat přímo <code>chr(13).chr(10)</code></li>
    <li>u <code>DESCRIPTION</code> nezapoměňte <code>htmlspecialchars_decode(str_replace(chr(13).chr(10),"\\n"))</code></li>
</ul>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Ladislav Prskavec</span></span>

      








  


<time datetime="2008-05-13T00:00:00+02:00" pubdate data-updated="true">13. 05. 2008</time>
      


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/2008/05/zkuenosti-s-zend_auth_adapter_ldap/" title="Previous Post: Zkušenosti s Zend_Auth_Adapter_Ldap">&laquo; Zkušenosti s Zend_Auth_Adapter_Ldap</a>
      
      
        <a class="basic-alignment right" href="/2008/05/problmy-s-internationalized-domain-names/" title="Next Post: Problémy s Internationalized domain names">Problémy s Internationalized domain names &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <ul id="recent_posts">
      <li class="post">
      <a href="http://blog.prskavec.net" alt="Home"><img class="icons" src="/images/Home.png" ></a>
      <a href="http://blog.prskavec.net/archives/" alt="Archives"><img  class="icons" src="/images/Calendar.png"></a>
      <a href="mailto:ladislav@prskavec.net" alt="E-Mail"><img  class="icons" src="/images/Envelope.png"></a>
      <a href="http://blog.prskavec.net/atom.xml" alt="subscribe feed"><img class="icons" src="/images/rss_big.png"></a>
      </li>
  </ul>
</section>
<section>
  <h1>Ladislav Prskavec</h1>
  <p style="margin-top:6px;"><img src="/images/avatar.jpg" style="float:left; margin-right:10px;" width="100" height="115" /><a href="http://github.com/abtris/">Programátor</a>, otec, <a href="http://www.dzogchen.cz">buddhista</a>, milovník dobrého jídla, knih, nových technologí a hraček pro všechny s&nbsp;duší dítěte.
</p>
  <br style="clear:left;"/>
</section>
<section>
  <h1>Poslední příspěvky</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2014/12/zapier-a-zasilani-zustatku-z-banky-zdarma-na-mobil/">Zapier a zasílání zůstatku z banky zdarma na mobil</a>
      </li>
    
      <li class="post">
        <a href="/2014/01/git-a-pre-commit-hook-pro-kontrolu-syntaxe-v-mnoha-jazycich/">Git a pre-commit hook pro kontrolu syntaxe</a>
      </li>
    
      <li class="post">
        <a href="/2013/11/docker/">docker</a>
      </li>
    
      <li class="post">
        <a href="/2013/09/jenkins-polling-a-git-notify/">Jenkins polling a git-notify</a>
      </li>
    
      <li class="post">
        <a href="/2013/08/firebase-a-angularjs/">Firebase a AngularJS</a>
      </li>
    
      <li class="post">
        <a href="/2013/06/angularjs-1-dot-2/">Jaký bude AngularJS 1.2?</a>
      </li>
    
      <li class="post">
        <a href="/2013/06/zdrojak-dan-menard-instant-angularjs-starter-recenze-prvni-knihy-o-angularjs/">Zdroják - Dan Menard: Instant AngularJS Starter (recenze první knihy o AngularJS)</a>
      </li>
    
      <li class="post">
        <a href="/2013/03/nodejs-hosting/">NodeJS Hosting</a>
      </li>
    
      <li class="post">
        <a href="/2012/12/railsgirls-v-praze/">RailsGirls v Praze</a>
      </li>
    
      <li class="post">
        <a href="/2012/10/praguejs-porada-s-gooddata-prednasku-o-ember-dot-js-prednasi-autori-frameworku-yehuda-katz-a-tom-dale/">PragueJS pořádá s GoodData přednášku o Ember.js. Přednáší autoři frameworku Yehuda Katz a Tom Dale.</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Subversion</h1>
  <p style="margin-top:6px; text-align:center"><a href="http://itunes.apple.com/cz/book/subversion/id498008712?mt=11" onClick="_gaq.push(['_trackEvent', 'link', 'itunes/subversion', 'svn-promo-sidebar-vpravo']);"><img src="http://a2.mzstatic.com/us/r30/Publication/v4/5c/1a/66/5c1a667d-2f78-b9b2-31ec-7c06ab9b74e8/B_SUBVERSION.225x225-75.jpg" style="float:left; margin-right:10px; width:172px; height:225px;" /></a>
</p>
  <br style="clear:left;"/>
</section>

<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/+LadislavPrskavec?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>


<section>
  <h1>GitHub</h1>

<iframe src="http://githubbadge.appspot.com/badge/abtris" style="border: 0;height: 142px;width: 200px;overflow: hidden;" frameBorder=0></iframe>

</section>
<section>
  <h1>Twitter</h1>
  <a class="twitter-timeline" width="250" height="500" href="https://twitter.com/abtris" data-widget-id="345276838232326144">Tweets by @abtris</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Ladislav Prskavec -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-79221-21']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
(function (d, w, c) {
    (w[c] = w[c] || []).push(function() {
        try {
            w.yaCounter21617953 = new Ya.Metrika({id:21617953,
                    webvisor:true,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true});
        } catch(e) { }
    });

    var n = d.getElementsByTagName("script")[0],
        s = d.createElement("script"),
        f = function () { n.parentNode.insertBefore(s, n); };
    s.type = "text/javascript";
    s.async = true;
    s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";

    if (w.opera == "[object Opera]") {
        d.addEventListener("DOMContentLoaded", f, false);
    } else { f(); }
})(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="//mc.yandex.ru/watch/21617953" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->


<script type="text/javascript">
      var disqus_shortname = 'prskavecblog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


<script src="/javascripts/all.js?v=1412111651"></script>



</body>
</html>
