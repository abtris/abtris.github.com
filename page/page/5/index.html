
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Prskavčí blog</title>
  <meta name="author" content="Ladislav Prskavec">

  
  <meta name="description" content="Co jsem řešil V poslední době jsem neměl moc času na psaní a když jsem chtěl psát, chtěl jsem se tomu věnovat, mít na to jednoduchý prostředek jako &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.prskavec.net/page//page/5/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/all.css?v=1412111641" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/feed/index.html" rel="alternate" title="Prskavčí blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
<meta name="google-site-verification" content="mepQHhq6JPqzvIjErdB-A6hp3UKAYIlYHN7xPUL8JUM" />

  
</head>

<body   >
  <header role="banner"><hgroup>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/feed/index.html" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.prskavec.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archív</a></li>
  <li><a href="/prednasky">Přednášky</a></li>
  <li><a href="/skoleni-a-kurzy">Školení a kurzy</a></li>
  <li><a href="/kontakt">Kontakt</a></li>
</ul>

</nav> 
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/09/Migrace-z-Wordpressu-na-Jekyll/">Migrace z Wordpressu na Jekyll</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-09-30T00:00:00+02:00" pubdate data-updated="true">30. 09. 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Co jsem řešil</h2>

<p>V poslední době jsem neměl moc času na psaní a když jsem chtěl psát, chtěl jsem se tomu věnovat, mít na to jednoduchý prostředek jako je Textmate (ByWord, iA Writer, WriteRoom, OmmWriter) a přitom se nemuset handrkovat s HTML a s tím jak mi občas nevhodné styly ničí text nebo kusy kódu.</p>

<p>Wordpress u mě na hostingu ještě narazil na limit starého MySQL a mě se také nechtělo migrovat na nový databázový server, potom mi také chybělo verzování v Gitu na který jsem zvykl.</p>

<p>Protože jsem před časem viděl, že <a href="http://pages.github.com">Github pages</a> se dají dobře použít pro vlastní blog, rozhodl jsem se na to přejít se svými blogy <a href="http://blog.prskavec.eu">TopTopic?</a> a <a href="http://blog.prskavec.net">Prskavčí blog</a>.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2011/09/Migrace-z-Wordpressu-na-Jekyll/">Dále &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/09/deployment-prakticky-webexpo-2011/">Deployment prakticky - WebExpo 2011</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-09-25T00:00:00+02:00" pubdate data-updated="true">25. 09. 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Letos jsem přednášel na Webexpu na téma deployment. Ve 30 minutách se nedá říci dost, aby jste se dozvěděli všechno tak zkusím v tomto článku shrnout o čem jsem mluvil a přidat nějaké zdroje, které pomůžou v dalších úsilí při automatizaci deploymentu.</p>

<h2 id="deployment">Deployment</h2>


<ul>
    <li>Nasazení dané aplikace na dané prostředí v daném čase s možností vrácení původní verze aplikace pokud možno s minimálními prostředky a náklady.</li>
</ul>


<h2 id="configuration_management">Configuration Management</h2>


<ul>
    <li>Služba, která se stará, aby námi zadaná konfigurace byla konzistentní napříč prostředím a na všech strojích a je to jeden nezbytných kroků pro CI.</li>
</ul>


<h2 id="continuous_integration">Continuous Integration</h2>


<p>CI pomáhá dramaticky snížit počet chyb při vývoji i v produkci pokud se to dělá dobře a důsledně.</p>

<p>Pro dobré fungovaní Continuous Integration potřebujete automatizovat deployment na prostředí. Na prostředích se často střídají aktuální feature větve vývojářů nebo se tam provádí update z větve pro release či sprint. K tomu se vše provádí několikrát denně. Abychom tohle mohli dělat potřebuje deployment mít plně automatický.</p>

<pre><code>"Automated deployment, tied into good CI discipline, is essential to making this work." - Martin Fowler
</code></pre>


<h2 id="tlatko_push">Tlačítko push</h2>


<p>Deployment musí být tak jednoduchý, aby ho zvládnul kdokoliv, kdo ho potřebuje a má potřebné oprávnění. Zdá se celkem jednoduché, ale není tomu tak. Pokud je potřeba například znalost linuxu (vytváření symlinku, ssh klient apod.), může to být pro část týmu třeba dost velká překážka, aby si něco nasadili a raději řeknou developerovi. On to má přece za minutku nasazené. Ale v tom je problém, pokud developer není po ruce, nebo nemá čas, tak část práce stojí. Obzvláště při agilním vývoji a krátkém sprintu to může být dost znát.</p>

<p>Pokud ještě se deployment dělá ručně, občas se na něco zapomene a jakákoliv ruční práce je zdrojem chyb. Celkově dojde k úspoře nákladů, protože čas ztrávený deploymentem firmě nikdo nezaplatí.</p>

<p>Za tlačítkem push si můžete představit jakýkoliv spouštěč, který vám vyhovuje (git push do příslušné větve, tlačítko na webu apod.).</p>

<p>Pokud nemáte zkušenost s gitem, tak rozvedu ten git push. Ostatní mohou odstavec přeskočit.</p>

<p>Git jako distribuovaný systém funguje jen lokálně a může mít svoje vzdálené kopie repository podobně jako v architektuře klient server (Subversion). Ale nemusí mít jen jedno místo kam se zdrojový kód odesílá pomocí git push. Toho se dá využít a používá se to tak, že kromě serveru kam ukládáte zdrojový kód (u mě například Github.com), který je označený jako origin (git push origin master &ndash; odešle kód tam), mohu například přidat místo kde se pushem přímo nasadí (git push heroku master &ndash; kód se odešle na cloud Heroku a dojde k jeho nasazení). Obdobně kromě místa, lze použít určité větve a mít na serveru hook script, který detekuje změny a provede nasazení.</p>

<ul>
    <li><a href="http://stackoverflow.com/questions/279169/deploy-a-project-using-git">http://stackoverflow.com/questions/279169/deploy-a-project-using-git</a></li>
    <li><a href="http://ryanflorence.com/deploying-websites-with-a-tiny-git-hook">http://ryanflorence.com/deploying-websites-with-a-tiny-git-hook </a></li>
</ul>


<h2 id="jak_to_nechat_na_jinch">Jak to nechat na jiných</h2>


<p>Pokud můžete a děláte projekt, kde se můžete dovolit využít hostingu, cloudu, který deployment vyřeší za vás, udělejte to. Ušetří vám to čas i prostředky. Samozřejmě ne vždy to jde, ale pro ty případy tu bude další kapitola.</p>

<h3 id="herokucom"><a href="http://heroku.com">Heroku.com</a></h3>


<ul>
    <li>Ruby, Node.js, Closure, Java (CLI client, rake pro příkazy jako jsou migrace db, hodně dodatečných služeb - <a href="http://addons.heroku.com/">http://addons.heroku.com/</a>)</li>
    <li>částečná podpora pro PHP a Python přes Facebook - <a href="https://developers.facebook.com/blog/post/558/">https://developers.facebook.com/blog/post/558/</a>.</li>
</ul>


<p>Další služby, recenze některých jsem dělal dříve.
&ndash; <a href="http://www.pagodabox.com"><a href="http://www.pagodabox.com">http://www.pagodabox.com</a></a>
&ndash; <a href="http://phpfog.com"><a href="http://phpfog.com">http://phpfog.com</a></a>
&ndash; <a href="http://orchestra.io/"><a href="http://orchestra.io/">http://orchestra.io/</a></a>
&ndash; <a href="http://www.engineyard.com"><a href="http://www.engineyard.com">http://www.engineyard.com</a></a>
&ndash; <a href="http://cloudcontrol.com/"><a href="http://cloudcontrol.com/">http://cloudcontrol.com/</a></a>
&ndash; <a href="http://relbit.com"><a href="http://relbit.com">http://relbit.com</a></a>
&ndash; <a href="http://nodester.com/"><a href="http://nodester.com/">http://nodester.com/</a></a></p>

<p>Samozřejmě jsem nemohl vyzkoušet podrobně každou cloudovou službu, na to nemám rozpočet a ne každá má k dispozici zdarma potřebný program pro vývojáře. Důležité aspoň pro mě je podpora práce z CLI kvůli možnosti automatizace, případně nějaké API, které to umožňuje. A také podpora vlastního nastavení a úkolů, aby jste mohli například automaticky spustit test nebo migraci databáze. Svoje zkušenosti nebo rady a doporučení uveďte do komentářů, budu rád.</p>

<h2 id="jak_si_to_vyrobit_sm">Jak si to vyrobit sám</h2>


<h3 id="rozdlen_nstroj_pro_deployment">Rozdělení nástrojů pro deployment</h3>


<ul>
    <li>balíčkovací systémy (<a href="http://en.wikipedia.org/wiki/Listofsoftwarepackagemanagement_systems">http://en.wikipedia.org/wiki/List<em>of</em>software<em>package</em>management_systems</a>)
<ul>
    <li>podle operačního systému (RPM, DEB)</li>
    <li>podle jazyka (phar, pear, gem, npm, cpan)</li>
</ul>
</li>
    <li>nástroje
<ul>
    <li>capistrano - <a href="http://capify.org/">http://capify.org/</a></li>
    <li>fabric - <a href="http://fabfile.org">http://fabfile.org</a></li>
    <li>cfengine - <a href="http://cfengine.com/">http://cfengine.com/</a></li>
    <li>puppet - <a href="http://puppetlabs.com/">http://puppetlabs.com/</a></li>
    <li>chef - <a href="http://www.opscode.com/">http://www.opscode.com/</a></li>
    <li>ant - <a href="http://ant.apache.org/">http://ant.apache.org/</a>, maven - <a href="http://maven.apache.org/">http://maven.apache.org/</a>, buildr - <a href="http://buildr.apache.org/">http://buildr.apache.org/</a></li>
    <li>make, rake, phake, phing apod.</li>
</ul>
</li>
</ul>


<h3 id="capistrano">Capistrano</h3>


<p>Instalace
&ndash; pro instalaci potřebujete ruby (windows &ndash; <a href="http://rubyinstaller.org/"><a href="http://rubyinstaller.org/">http://rubyinstaller.org/</a></a>, mac &ndash; součást OS)
&ndash; pokud budete deployment dělat pro ruby aplikaci nepotřebujete samozřejmě railsless-deploy</p>

<pre><code>gem install capistrano capistrano-ext railsless-deploy
</code></pre>


<p>Zdrojový kód si stáhněte z <a href="https://github.com/abtris/webexpo2011-wordpress.git">githubu</a>.</p>

<pre><code>git clone https://github.com/abtris/webexpo2011-wordpress.git
</code></pre>


<p>Zajímají nás tyto soubory:</p>

<pre><code>Capfile
templates/apache.conf.erb
config/deploy/development.rb
config/deploy/production.rb
config/deploy/apache.rb
config/deploy/deploy.rb
</code></pre>


<p>které nám umožňují dělat deployment:
cap deploy
cap development deploy
cap production deploy</p>

<p>a configuration management:</p>

<pre><code>cap apache:setup
cap apache:start
cap apache:stop
cap apache:restart
</code></pre>


<h3 id="praktick_ukzka_capistrana_na_videu">Praktická ukázka Capistrana na videu</h3>


<ul>
    <li>používám virtuální server pro deployment, který je vytvořen pomocí Vagrant (<a href="http://www.vagrantup.com">www.vagrantup.com</a>) a Chef</li>
    <li>ukázka jak se vytváří Jenkins server pro testovaní - <a href="https://github.com/abtris/vagrant-hudson">https://github.com/abtris/vagrant-hudson</a></li>
</ul>


<iframe width="420" height="315" src="http://www.youtube.com/embed/MisWQe4JhEQ" frameborder="0" allowfullscreen></iframe>


<h2 id="jenkins_jak_se_to_dl_v_jobscz">Jenkins - jak se to dělá v Jobs.cz</h2>


<ul>
    <li>v LMC (jobs.cz, prace.cz) je vývoj v Javě a PHP. Pro oboje používáme od roku 2008 na build Hudson dnes Jenkins. Pro Javu se přechází na build postavená na Mavenu a v PHP používáme build napsaný v Antu, který vytváří RPM balíčky pro nasazení CFEngine nebo pomocí skriptu přímo z Jenkins.</li>
    <li>jak vyrobit RPM pro PHP - ukázka s kódem k dispozici <a href="https://github.com/abtris/barcamp2010praha">https://github.com/abtris/barcamp2010praha</a></li>
</ul>


<p>etc/demoapp.spec</p>

<pre><code>Summary: Demo App
Name: @@PACKAGE_NAME@@
Version: @@VERSION@@
Release: @@BUILD@@
License: Copyright by Ladislav Prskavec
Group: System Environment/Internet
BuildRoot: @@BUILDROOT@@

#topdir
%define _topdir @@TOPDIR@@
%define _target_os Linux

%description
Barcamp 2010 demo app

%install
mkdir -p $RPM_BUILD_ROOT/srv/www/demoApp/@@CURRENT@@
cp -r ${FILENAME}-${VERSION}/* $RPM_BUILD_ROOT/srv/www/demoApp/@@CURRENT@@/

%clean
[ "${RPM_BUILD_ROOT}" != "/" ] &amp;&amp; rm -rf ${RPM_BUILD_ROOT}

%files
/srv/www/demoApp/@@CURRENT@@

%defattr(755,root,root)
%dir /srv/
%dir /srv/www
%dir /srv/www/demoApp/
%dir /srv/www/demoApp/@@CURRENT@@/

%post
echo "run: ln -nfs /srv/www/demoApp/@@CURRENT@@/ /srv/www/demoApp/current"
</code></pre>


<p>a k tomu příslušný build script</p>

<pre><code>&lt;project name="project_name" default="clean" basedir="."&gt;
&lt;!-- task definition for cycle --&gt;
&lt;taskdef resource="net/sf/antcontrib/antlib.xml"/&gt;
    &lt;description&gt;
        barcamp demo app
    &lt;/description&gt;

  &lt;!-- options from properties file --&gt;
  &lt;!-- ${ws} is in Hudson $WORKSPACE --&gt;
  &lt;echo message="reading properties from: ${ws}/etc/build.properties" /&gt;
  &lt;echo message="module name ${modulename}" /&gt;
  &lt;property file="${ws}/etc/build.properties"/&gt;
  &lt;!-- options from .spec file --&gt;
  &lt;property name="spec_file" value="/etc/${modulename}.spec" /&gt;
  &lt;!--  make unique rpm_build_root, solve problems with branches --&gt;
  &lt;exec executable="mktemp" outputproperty="rpm_build_root"&gt;
    &lt;arg value="-d" /&gt;
    &lt;arg value="-t" /&gt;
    &lt;arg value="${modulename}.XXXXXXXXXX" /&gt;
  &lt;/exec&gt;
  &lt;echo message="RPM Build root set to: ${rpm_build_root}" /&gt;
  &lt;!-- set global properties for this build --&gt;
  &lt;property name="build" location="${rpm_build_root}/BUILD"/&gt;
  &lt;property name="rpms" location="${rpm_build_root}/RPMS"/&gt;

 &lt;target name="init"&gt;
    &lt;!-- Create the time stamp --&gt;
    &lt;tstamp/&gt;
    &lt;!-- Create the build directory structure used by compile --&gt;
    &lt;mkdir dir="${build}"/&gt;
    &lt;mkdir dir="${rpms}/i386"/&gt;
  &lt;/target&gt;

 &lt;target name="gitrevision" unless="REV" depends="init"&gt;
   &lt;exec executable="git" output="${rpm_build_root}/gitinfo"&gt;
     &lt;arg value="rev-list"/&gt;
     &lt;arg value="--all"/&gt;
   &lt;/exec&gt;
   &lt;exec executable="wc" output="${rpm_build_root}/wcinfo"&gt;
     &lt;arg value="-l" /&gt;
     &lt;arg value="${rpm_build_root}/gitinfo" /&gt;
   &lt;/exec&gt;
   &lt;exec executable="awk" outputproperty="REV"&gt;
     &lt;arg value="{ print $1 }"/&gt;
     &lt;arg value="${rpm_build_root}/wcinfo"/&gt;
   &lt;/exec&gt;
   &lt;echo message="REV: ${REV}" /&gt;
 &lt;/target&gt;

 &lt;target name="gitexport" depends="gitrevision"&gt;
  &lt;mkdir dir="${build}/${modulename}-${REV}" /&gt;
  &lt;copy todir="${build}/${modulename}-${REV}"&gt;
    &lt;fileset dir="../"&gt;
      &lt;exclude name="../.git/*"/&gt;
    &lt;/fileset&gt;
  &lt;/copy&gt;
   &lt;echo message="Coping files ..." /&gt;
 &lt;/target&gt;

 &lt;!-- take spec files  --&gt;
 &lt;target name="spec" depends="gitexport"&gt;
        &lt;!-- get spec files --&gt;
        &lt;path id="spec.files"&gt;
            &lt;fileset  dir="${build}/${modulename}-${REV}/etc"&gt;
                &lt;include name="*.spec"/&gt;
            &lt;/fileset&gt;
        &lt;/path&gt;
        &lt;!-- convert slashes to unix (necessary for Win) --&gt;
        &lt;pathconvert pathsep="," targetos="unix" property="files" refid="spec.files"/&gt;

        &lt;echo message="Call RPM" /&gt;
        &lt;!-- Call RPM for all spec files (task for need antcontrib --&gt;
        &lt;for list="${files}" param="item"&gt;
        &lt;sequential&gt;
            &lt;antcall target="replace"&gt;
                &lt;param name="spec_file" value="@{item}"/&gt;
            &lt;/antcall&gt;
            &lt;antcall target="rpm"&gt;
                &lt;param name="spec_file" value="@{item}"/&gt;
            &lt;/antcall&gt;
        &lt;/sequential&gt;
        &lt;/for&gt;

 &lt;/target&gt;

  &lt;!-- replace tokens in spec files --&gt;
  &lt;target name="replace"&gt;
    &lt;replace file="${spec_file}" token="@@CURRENT@@" value="${major_version}-${REV}"/&gt;
    &lt;replace file="${spec_file}" token="@@TOPDIR@@" value="${rpm_build_root}"/&gt;
    &lt;replace file="${spec_file}" token="${VERSION}" value="${REV}"/&gt;
    &lt;replace file="${spec_file}" token="${FILENAME}" value="${modulename}"/&gt;
    &lt;basename property="spec.filename" file="${spec_file}" suffix=".spec" /&gt;
    &lt;echo message="${spec.filename}" /&gt;
    &lt;replace file="${spec_file}" token="@@PACKAGE_NAME@@" value="${spec.filename}"/&gt;
    &lt;replace file="${spec_file}" token="@@VERSION@@" value="${major_version}"/&gt;
    &lt;replace file="${spec_file}" token="@@BUILD@@" value="${REV}"/&gt;
    &lt;replace file="${spec_file}" token="@@BUILDROOT@@" value="${rpm_build_root}-${spec.filename}/" /&gt;
    &lt;replace file="${spec_file}" token="@" value=""/&gt;
  &lt;/target&gt;

 &lt;!-- rpmbuild  --&gt;
 &lt;target name="rpm"&gt;
   &lt;echo message="SPEC: ${spec_file}" /&gt;
   &lt;exec executable="rpmbuild"&gt;
      &lt;arg value="--target=i386"/&gt;
      &lt;arg value="-bb"/&gt;
      &lt;arg value="${spec_file}"/&gt;
   &lt;/exec&gt;

 &lt;/target&gt;

  &lt;!-- copy RPM files to TOP_DIR and delete tmp dirs --&gt;
  &lt;target name="clean" depends="spec"&gt;
    &lt;copy todir="${target_path}"&gt;
        &lt;fileset  dir="${rpms}/i386/"&gt;
        &lt;include name="*.rpm"/&gt;
    &lt;/fileset&gt;
    &lt;/copy&gt;  &lt;/target&gt;

&lt;/project&gt;
</code></pre>


<h3 id="infrastructure_as_code">Infrastructure As code</h3>


<p>Pokud máte k dispozici více prostředí, nebo pokud používáte masivnější virtualizaci jistě víte, že to bez automaticace nejde.</p>

<p>K nejznámějším nástrojům patří CFEngine, Puppet a Chef.</p>

<pre><code>1993 - CFEngine
2002 - CFEngine 2
2005 - Puppet
2009 - CFEngine 3, Chef
</code></pre>


<p>O chefu jsem se zmiňoval již dříve, je vhodný právě například pro tvorbu virtualizací ve velkém. Pro příklad uvedu cluster <a href="http://blog.cyclecomputing.com/2011/09/new-cyclecloud-cluster-is-a-triple-threat-30000-cores-massive-spot-instances-grill-chef-monitoring-g.html">Nostromu</a>, který měl 30 000 jader.</p>

<p>Puppet
&ndash; <a href="http://www.puppetlabs.com">http://www.puppetlabs.com</a>
&ndash; napsaný v Ruby, odvozený od cfengine
&ndash; klient aktualizuje konfiguraci v pravidelných intervalech a reportuje zpět na server (Puppet Master)
&ndash; perfektní pro “sysadmins”
&ndash; deklarativní popis nastaveni</p>

<p>Chef
&ndash; <a href="http://www.opscode.com/chef">http://www.opscode.com/chef</a>
&ndash; v Ruby, odvozený od Puppetu
&ndash; Ruby DSL
&ndash; cloud provisioning
&ndash; imperativní popis, více flexibilní, více pro “vývojáře”
&ndash; pokud by vás to zajímalo doporučuji zajít na <a href="bit.ly/skolenichef">školení Radima Marka</a> (GoodData) &ndash; s kódem WEBEXPO2011 by měla být sleva 15%</p>

<h2 id="slidy">Slidy</h2>


<div style="width:425px" id="__ss_9388737"> <strong style="display:block;margin:12px 0 4px"><a href="http://www.slideshare.net/ladislavprskavec/deployment-prakticky" title="Deployment prakticky" target="_blank">Deployment prakticky</a></strong> <iframe src="http://www.slideshare.net/slideshow/embed_code/9388737" width="425" height="355" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe> <div style="padding:5px 0 12px"> View more <a href="http://www.slideshare.net/" target="_blank">presentations</a> from <a href="http://www.slideshare.net/ladislavprskavec" target="_blank">Ladislav Prskavec</a> </div> </div>


<h2 id="zvr_co_si_odnst">Závěr - co si odnést</h2>


<ul>
    <li>Existují kvalitní nástroje pro deployment, použijte je!</li>
    <li>Každý oprávněný uživatel si lehce zjistí informaci o verzi aplikace na příslušném prostředí a jednoduše si nasadí verzi aplikace, kterou potřebuje na prostředí, kde to potřebuje.</li>
    <li>Jedině automatizací se vyhnete chybám. Každý ruční postup jednou selže.</li>
    <li>Uspoříte velké náklady, protože čas ztraceny deploymentem nepřináší žádný zisk.</li>
</ul>




<blockquote><p><h4>Jenkins - jak na Continuous Integration v PHP</h4><br/>Pochopení a využití procesu Continuous Integration s využitím nástroje Jenkins vám pomůže zvýšit kvalitu softwaru, který vyvíjíte, a zároveň snížit čas na jeho dodávku. Continuous Integration vám umožňuje kontrolovat kvalitu softwaru průběžně po malých částech a minimalizovat tak riziko rozsáhlých chyb, jak tomu bylo v případě klasického vodopádového přístupu.</p><footer><strong>Ladislav Prskavec - Kurz Jenkins</strong> <cite><a href='http://webexpo.cz/academy/kurzy/jenkins-jak-na-continuous-integration-v-php'>WebExpo Academy</a></cite></footer></blockquote>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/09/webexpo-2011-na-co-pujdu/">WebExpo 2011 - Na co půjdu</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-09-19T00:00:00+02:00" pubdate data-updated="true">19. 09. 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Jako vývojář jsem si vybral přednášky v Development Room a Development Hall.</p>

<p>V pátek začnu na přednášce co má Michal Táborský o Architektuře škálovatelných aplikací, jistě se dozvíme jak to dělají v Mall.cz. Michala znám a jeho vyprávění a postřehy mi přijdou velmi podobné tomu jako to řešíme v práci i my. Pokračovat budu na své přednášce, kde řeknu něco o tom proč automatizovat deployment, co na to použít. Jak to řešíme v LMC (Jobs.cz, Prace.cz). Po mě na podobné téma Honza Mittner bude pokračovat o konkrétním řešení deploymentu pro PHP u nich v agentuře.</p>

<p>V další sekci je na téma Javascript. JIŘÍ KNESL bude ukazovat Test Driven Development v CoffeeScriptu. Po něm bude pokračovat VOJTA JÍNA s MVC frameworkem  AngularJS. Protože používím BackboneJS, zajímá mě srovnání s AngularJS.</p>

<p>Protože ve svých projektech používám Google Maps Api, zajímají mě přednášky o konkurenci. Podívám se jak to dělají u Nokie (MICHAL AICHINGER, Nestačí vám vaše oblíbené mapové API? Zkuste Nokia mapy) a u Seznamu, kde nám ADAM CHVAJA řekne o On-line mapách u nás a ve světě.</p>

<p>Protože, pracuji s CouchDB a provoz MongoDB se spíše vyhýbám, tak se těším na zkušenosti z Centra v přednášce Lukáše LINHARTa o  MongoDB.</p>

<p>Nakonec to nejlepší DOUGLAS CROCKFORD, Serversideness, jednoznačná nejzajímavější přednáška letošního Webexpa, doufám, že nezklame.</p>

<p>V sobotu budeme pokračovat, nejprve se podívám na to co bude PAVEL CAMPR a JIŘÍ PRAUS povídat o Symfony 2, které mi přijde asi jako nejpropracovanější PHP framework dneška. RASMUS LERDORF a jeho PHP in 2011 je povinnost pro každého kdo programuje aspoň trochu v PHP. Michal Špaček ze Skypu a jaho Strategie kešování jistě nezklame.</p>

<p>Velice se těším na přednášku Scala &ndash; jazyk budoucnosti, ZDENĚK FARANA nám ukáže v čem je tento jazyk tak zajímavý a já dám možná JVM ještě někdy šanci.</p>

<p>KAREL MINAŘÍK a LUKÁŠ VLČEK jsou nejznámější vývojáři co mají u nás dělají s ElasticSearch. Karel je autorem ruby gemu Tire na práci s ES a Lukáš napsal jeden z nástrojů pro monitoring a přispívá k vývoji ES. Jejich ElasticSearch: Za hranice běžného fulltextového vyhledávání bude jistě jedna z nejzajímavějších přednášek Webexpa.</p>

<p>HONZA KRÁL je známý Python vývojář a ukáže nám jak se má psát kód tak, aby byl testovatelný a jeho Testování prakticky určitě bude zajímavé pro všechny vývojáře i testery. JAKUB VRÁNA s přednáškou Ajaxizace určitě zaujme.</p>

<p>Doufám, že se tam uvidíme a zkuste dát svoje tipy co vás zaujalo.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/04/php-a-rabbitmq/">PHP a RabbitMQ</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-04-10T00:00:00+02:00" pubdate data-updated="true">10. 04. 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>V poslední době se objevilo hodně článků o <a href="http://www.rabbitmq.com/">RabbitMQ</a> a připravuje se <a href="http://manning.com/videla/">kniha</a> kde většina příkladů je v PHP.  Připravil jsem malou demonstraci jak se message queue dobře využit. RabbitMQ je napsaný v Erlangu podobně jako CouchDB a hodí ke zpracování dávkových úloh. V demonstraci využívám knihovnu <a href="http://code.google.com/p/wkhtmltopdf/">wkhtmltopdf</a> která umí zpracovat html stránku na PDF, používá k tomu webkit jádro.</p>

<h2>Design</h2>


<p>Malý design aplikace jsem zvolil takto:  <img class="aligncenter" title="rabbitmq_design" src="https://github.com/abtris/php-rabbitmq-wkhtmltox-demo/raw/master/docs/design.png" alt="" width="600" /></p>

<h2>Kód</h2>


<p>Základ aplikace jsou dva úlohy producer a consumer. Nejdříve je potřeba pustit consumer.</p>

<pre class="code">error_reporting(E_ALL);
/**
 * Application path
 */
define('APPLICATION_PATH', realpath(dirname(__FILE__) . '/../application'));
/**
 * Application enviroment
 */
define('APPLICATION_ENV', 'development');

require_once APPLICATION_PATH . '/models/Rabbit.php';
/**
 * /Ensure library/ is on include_path
 */
set_include_path(implode(PATH_SEPARATOR, array(
    realpath(APPLICATION_PATH . '/../library'),
    get_include_path()
)));

/** Zend_Application */
require_once 'Zend/Application.php';

// Create application, bootstrap, and run
$application = new Zend_Application(
    APPLICATION_ENV,
    APPLICATION_PATH . '/configs/application.ini'
);
$application-&gt;getBootstrap()-&gt;bootstrap();

$config = new Zend_Config_Ini(APPLICATION_PATH . '/configs/application.ini', APPLICATION_ENV);

$r = new Application_Model_Rabbit($config-&gt;rabbitmq);
$r-&gt;consumer();</pre>


<p>Tento script musí běžet na serveru, kde se zpracovává vlastní požadavek. Model potom volá metodu, která se vykoná.</p>

<pre class="code">        $conn = new AMQPConnection($this-&gt;options['host'],
                                   $this-&gt;options['port'],
                                   $this-&gt;options['user'],
                                   $this-&gt;options['pass'],
                                   $this-&gt;options['vhost']
        );

        $channel = $conn-&gt;channel();
        /**
         * $exchange, $type,$passive=false,$durable=false,$auto_delete=true,
         */
        $channel-&gt;exchange_declare(self::EXCHANGE, 'direct', false, true, false);
        $channel-&gt;queue_declare(self::QUEUE);
        $channel-&gt;queue_bind(self::QUEUE, self::EXCHANGE);

        $consumer = function($msg) {
          $msg-&gt;delivery_info['channel']-&gt;basic_cancel($msg-&gt;delivery_info['delivery_tag']);
          if ($msg-&gt;body == 'quit') {
              $msg-&gt;delivery_info['channel']-&gt;basic_cancel($msg-&gt;delivery_info['consumer_tag']);
          } else {
              if (!empty($msg-&gt;body))  {
                  // make PDF
                  Application_Model_Wkhtmltopdf::proceed($msg-&gt;body, APPLICATION_PATH . '/../output/');
                  // notify user
                  system("growlnotify -n \"Rabbit demo\" -m \"PDF CREATED\"");
              }
          }
        };

        $channel-&gt;basic_consume(self::QUEUE,
                                self::CONSUMER_TAG,
                                false,
                                false,
                                false,
                                false,
                                $consumer);
        while (count($channel-&gt;callbacks)) {
            $channel-&gt;wait();
        }

        $channel-&gt;close();
        $conn-&gt;close();</pre>


<p>Vlastní aplikace je potom jednoduchá</p>

<pre class="code">    public function indexAction()
    {
        $r = new Application_Model_Rabbit($this-&gt;_config-&gt;rabbitmq);

        $this-&gt;view-&gt;form = $form = new Application_Form_AddUrl();
        // process form
        if ($this-&gt;getRequest()-&gt;isPost()) {
            $formData = $this-&gt;getRequest()-&gt;getParams();
            if ($form-&gt;isValid($formData)) {
                $r-&gt;setUrl($form-&gt;url-&gt;getValue());
                $r-&gt;run();
            } else {
                $form-&gt;populate($formData);
            }
        }

        $this-&gt;view-&gt;url = $r-&gt;getUrl();
    }</pre>


<p>a volá se producer, který invokuje RabbitMQ</p>

<pre class="code">        $conn = new AMQPConnection($this-&gt;options['host'],
                                   $this-&gt;options['port'],
                                   $this-&gt;options['user'],
                                   $this-&gt;options['pass'],
                                   $this-&gt;options['vhost']
        );
        $channel = $conn-&gt;channel();
        $channel-&gt;exchange_declare(self::EXCHANGE,
                                   'direct',
                                   false,
                                   true,
                                   false);
        $msg = new AMQPMessage($string, array('content-type' =&gt; 'text/plain'));
        $channel-&gt;basic_publish($msg, self::EXCHANGE);
        $channel-&gt;close();
        $conn-&gt;close();</pre>


<p>Demo u mne funguje velmi dobře, nevím jak na jiných platformách, zkoušel jsem to jen na Macu. Na linuxu by to mělo fungovat obdobně. Jen pro webovou aplikaci by bylo vhodné použít jiný systém notifikace pro webovou aplikaci. Nenašel jsem jak například předávat notifikace přes RabbitMQ, ale pokud někdo víte jak to elegatně udělat přidejte to do komentářů.</p>

<p>Veškerý zdrojový kód je <a href="https://github.com/abtris/php-rabbitmq-wkhtmltox-demo">dostupný na githubu</a>.</p>

<p>Zvolil jsem jednoduché jednosměrné řešení bez implementace RPC, kde by se dala pro notifikaci použít reply fronta. Ale myslím, že to celkem stačí pro vetšinu dávkových aplikací jako jsou logovaní, upload souborů i generovaní PDF. Nic nebrání nahradit moji notifikaci například posláním linku ke stažení výsledného PDF apod. Příklad by šel pomocí RPC vylepšit na notifikaci přímo v aplikaci. Pro implementaci RPC lze například použít <a href="https://github.com/tnc/Thumper">Thumper</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/03/phpfog-cloudove-reseni-pro-php/">phpfog - cloudové řešení pro PHP?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-03-14T00:00:00+01:00" pubdate data-updated="true">14. 03. 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Pokud se zajímáte o cloudové technologie, tak možná znáte <a href="http://heroku.com/">Heroku</a>. Heroku je pěkné řešení pro Ruby, které vám umožní vytvářet aplikace v Sinatře nebo v Rails a deployment provádět pomocí Gitu. Pro PHP mi něco takového dlouho chybělo, ale začíná se částečně situace vylepšovat, protože je na světe <a href="http://phpfog.com">PHP Fog</a>.</p>

<p><a href="http://blog.prskavec.net/wp-content/uploads/2011/03/phpfog-homepage-3.jpg"></a><a href="http://blog.prskavec.net/wp-content/uploads/2011/03/phpfog-homepage-4.jpg"><img class="aligncenter size-medium wp-image-6432" title="phpfog-homepage-4" src="http://blog.prskavec.net/wp-content/uploads/2011/03/phpfog-homepage-4-300x163.jpg" alt="" width="300" height="163" /></a></p>

<h2>Co vám přinese PHP Fog</h2>


<p>Mě se na cloudovém řešení libí, že je to pro vývojáře jednoduché a praktické. Nemusím řešit server, jeho provoz. Jen si nastavím konfiguraci apache, php.ini a vytvořenou aplikaci si přes git push pošlu na server k deploymentu a za pár okamžiků to běží.</p>

<p>Podobně to lehce vyřeším i na svém serveru pomocí SSH a Capistrano, ale stejně se musím starat o instalaci VPS. Jednodušší varianta je jen hosting s SSH přístupem například co mám na <a href="http://www.hostmonster.com">Hostmonster</a>. Tam je problém, ale se škálováním pokud by se stal projekt úspěšný.</p>

<p>Ukážu jak jsem během 5min rozběhl Zend Framework projekt s CouchDb hostovanou na couchone hostingu. Můžete použít MySQL, další db přímo hosting nepodporuje. Doufám, že to časem rozšíří hlavně o podporu PostgreSQL a některé NoSQL (CouchDb, MongoDb).</p>

<ul>
    <li>PHP Version 5.3.2</li>
    <li>Apache Version 2.2.14</li>
    <li>MySQL Version 5.1.41</li>
</ul>


<h2>Vytvoření nové aplikace</h2>


<p>Po přihlášení, zatím přístup je omezen, registrace přes nějaké <a href="https://phpfog.com/#sign-up">Sign Up kódy</a>, dostupný link najdete na homepage PHP Fog. Pokud chci vytvořit novou aplikaci, musím si vybrat profil, kde jsou setupy pro známé frameworky nebo přímo aplikace.</p>

<p><a href="http://blog.prskavec.net/wp-content/uploads/2011/03/phpfog-newapp-3.jpg"><img class="aligncenter size-medium wp-image-6422" title="phpfog-newapp-3" src="http://blog.prskavec.net/wp-content/uploads/2011/03/phpfog-newapp-3-300x171.jpg" alt="" width="300" height="171" /></a></p>

<p>Já jsem zvolil zend framework a pokračoval k dalšímu kroku, kde si vybere formu hostingu. Na prvních 6 měsíců můžete zvolit variantu zdarma. V dokumentaci se píše, že bude po těch 6 měsících nějak zpoplatněna. To si myslím, že není moc dobrý tah a autoři doufám od toho upustí.</p>

<p><a href="http://blog.prskavec.net/wp-content/uploads/2011/03/phpfog-price-3.jpg"><img class="aligncenter size-medium wp-image-6423" title="phpfog-price-3" src="http://blog.prskavec.net/wp-content/uploads/2011/03/phpfog-price-3-300x116.jpg" alt="" width="300" height="116" /></a></p>

<p>Po zvolení tarifu tak se dostanete do nastavení kde je potřeba poladit pár věcí a udělat si checkout Git repository pro váš projekt. Najde si v nastavení také nastavení Vhostu apache a php.ini.</p>

<p>Hlavní nastavení je nahrání SSH public key pro přístup ke Gitu, podobně jako na Githubu. Škoda, že se nedá přímo integrovat například pomocí nastavení remote větve na Github server. SSH a FTP přístup není k dispozici.</p>

<p><a href="http://blog.prskavec.net/wp-content/uploads/2011/03/phpfog-sourcecode-3.jpg"><img class="aligncenter size-medium wp-image-6424" title="phpfog-sourcecode-3" src="http://blog.prskavec.net/wp-content/uploads/2011/03/phpfog-sourcecode-3-300x99.jpg" alt="" width="300" height="99" /></a></p>

<p>Potom jsem udělal git checkout, nahrál do repository kód a pomocí git push spustil aplikaci, která běží na doméně podle jména které zadáte při vytváření aplikace. Provoz aplikace částečně můžete kontrolovat pomocí nahlížení do logů apache přes webové rozhraní.</p>

<p><a href="http://blog.prskavec.net/wp-content/uploads/2011/03/phpfog-logs-3.jpg"><img class="aligncenter size-medium wp-image-6421" title="phpfog-logs-3" src="http://blog.prskavec.net/wp-content/uploads/2011/03/phpfog-logs-3-300x157.jpg" alt="" width="300" height="157" /></a></p>

<h2>Závěr</h2>


<p>Projekt je na začátku a doufám, že bude mít štěstí a že se mu brzo objeví i další konkurenti, protože do Heroku to má daleko, ale jdou dobrou cestou. Trochu mi přijde cenová politika trochu dražší než bežná jiná řešení, ale asi to bude daň za provoz na Amazon cloudu (MySQL).</p>

<p>Pokud jste to někdo další vyzkoušeli nebojte se o to s námi podělit, případně nevíte někdo o dalších alternativách pro PHP?</p>

<p>&nbsp;</p>

<p>&nbsp;</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/02/podpora-profilovani-cachegrindkcachegrind/">Podpora profilování cachegrind/KCachegrind v Xdebugu</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-02-23T00:00:00+01:00" pubdate data-updated="true">23. 02. 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Dnes je část profilování v Xdebugu (<a title="Xdebug je open-source nástroj na ladění PHP. " href="http://xdebug.org"><a href="http://xdebug.org">http://xdebug.org</a></a>) ukládána do souborů v KCacheGrind formátu. Tato funkce byla přidána do Xdebugu, ale není dle <a href="http://kcachegrind.sourceforge.net/html/CallgrindFormat.html">specifikace formátu</a>. Byla vytvořena revezním inženýrstvým a tato stávající implementace obsahuje chyby a nepřesnosti.</p>

<p>Od verze 0.6 je KCacheGrind více striktní ohledně interpretace formátu a to způsobuje chyby při jeho používání s výstupy Xdebugu  <a href="https://bugs.kde.org/show_bug.cgi?id=256425"><a href="https://bugs.kde.org/show_bug.cgi?id=256425">https://bugs.kde.org/show_bug.cgi?id=256425</a></a>.</p>

<p><strong>Vybraná částka</strong> bude použita, aby <strong>Derick Rethans</strong> mohl správně vyřešit problém s integrací Xdebugu/KCacheGrindu. Správně vyřešit znamená, že předělá celou část zapisu profilovacích souborů. Rozhodně se tedy nejedná jen o jednoduchou opravu chyby jako je přidání jednoho řádku.</p>

<p><strong>Dnes 2.3.2011 byla částka úspěšně vybrána, všem co přispěli na dobrou věc děkuji.</strong></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/02/phpstorm-2-0/">PHPStorm 2.0 - nová verze multiplatformního vývojového prostředí</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-02-14T00:00:00+01:00" pubdate data-updated="true">14. 02. 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Dnes 14.2.2011 vyšela nová verze IDE pro PHP od <a title="JetBrains :: World's Leading Vendor of Professional Development Tools" href="http://www.jetbrains.com/">JetBrains</a> <a title="PHP IDE :: JetBrains PhpStorm" href="http://www.jetbrains.com/phpstorm/">PHPStorm 2.0</a>.</p>

<h3>Hlavní výhody tohoto IDE</h3>


<ul>
    <li>základní vlastnosti IDE
<ul>
    <li>jednoduchá instalace</li>
    <li>rychlý start</li>
    <li>funguje na Windows, Linux a Mac OS X</li>
    <li>jednoduchá konfigurace projektů, můžete začít kde chcete</li>
</ul>
</li>
    <li>inteligentní php editor
<ul>
    <li>doplňování kódu</li>
<a href="http://blog.prskavec.net/wp-content/uploads/2011/02/php-code-completation-2.jpg"><img class="aligncenter size-full wp-image-6379" title="php-code-completation-2" src="http://blog.prskavec.net/wp-content/uploads/2011/02/php-code-completation-2.jpg" alt="" width="700" /></a>
    <li>refaktoring</li>
    <li>podpora pro Smarty a PhpDoc</li>
<a href="http://blog.prskavec.net/wp-content/uploads/2011/02/phpdoc-support-1-2.jpg"><img class="aligncenter size-full wp-image-6381" title="phpdoc-support-1-2" src="http://blog.prskavec.net/wp-content/uploads/2011/02/phpdoc-support-1-2.jpg" alt="" width="298" height="136" /></a>
<a href="http://blog.prskavec.net/wp-content/uploads/2011/02/php-doc-support-2-2.jpg"><img class="aligncenter size-medium wp-image-6380" title="php-doc-support-2-2" src="http://blog.prskavec.net/wp-content/uploads/2011/02/php-doc-support-2-2-300x178.jpg" alt="" width="300" height="178" /></a>
    <li>rychlá navigace (fuzzy search)</li>
    <li>editor pro mixování jazyků (html, js, xml, xsl)</li>
    <li>vlastní různé konfigurace vzhledů IDE kompatibilní s IDEA platform (IDEA, Rubymine)</li>
</ul>
</li>
    <li>pokročilý javascriptový editor
<ul>
    <li>procházení DOMu</li>
    <li>javascriptový debugger</li>
    <li>javascriptový refaktoring</li>
    <li>jako u php je navigace v kódu a vyhledávání užití</li>
</ul>
</li>
    <li>html a css editor
<ul>
    <li>podpora HTML5</li>
    <li><a title="zen-coding - Project Hosting on Google Code" href="http://code.google.com/p/zen-coding/">Zen</a> coding</li>
    <li>validace a rychlé opravy</li>
    <li>ukázky aplikovaných stylů</li>
</ul>
</li>
    <li>chytré prostředí
<ul>
    <li>podpora pro <a href="http://www.phpunit.de">phpunit</a></li>
    <li>podpora verzovacích systémů (<a href="http://subversion.apache.org">SVN</a>, CVS, <a href="http://www.git-scm.com">Git</a>, Mercurial a další)</li>
    <li>FTP a synchronizace vzdálených souborů</li>
    <li>Lokální historie souborů</li>
</ul>
</li>
    <li>visuální debugger
<ul>
    <li>podpora pro xdebug i zend debugger</li>
    <li><a href="http://blogs.jetbrains.com/webide/2011/02/zero-configuration-debugging-with-xdebug-and-phpstorm-2-0/">jednoduchá konfigurace</a></li>
    <li>breakpointy v PHP, JS, HTML</li>
</ul>
</li>
</ul>


<p><a href="http://blog.prskavec.net/2010/02/jetbrains-phpstorm/">Minulý rok jsem psal o verzi 1.0</a>, od té doby prostředí bylo velmi vylepšeno a stále se pracuje na vylepšení. Jetbrains chtějí konkurovat Zend Studiu a to není lehký soupeř.</p>

<p>Osobně mě nejvíce vyhovuje fuzzy vyhledávání v souborech, kde lehce najdu při práci se Zend Frameworkem příslušnou šablonu ke controlleru a velmi slušně funguje i potřebné vyhledání užití nebo nápověda.</p>

<p><a href="http://blog.prskavec.net/wp-content/uploads/2011/02/quick-documentation.jpg"><img class="aligncenter size-full wp-image-6387" title="quick-documentation" src="http://blog.prskavec.net/wp-content/uploads/2011/02/quick-documentation.jpg" alt="" width="764" /></a></p>

<p>V práci používám Zend Studio. Doma jsem dříve pracoval v Netbeans. Minulý rok jsem si při přechodu Mac OS X si koupil licenci PHPStorm 1.0, která obsahuje i 1 rok podpory včetně všech upgradů (tedy i verze 2.0) na které pracuji doteď. Zadal jsme několik chyb a podnětů a všemi se vývojáři zabývali a nějak je řešili.</p>

<p>Závěrem chci říct, že IDE je potřeba vyzkoušet a uvidíte jak jak vám sedne. Trial verze je zdarma k vyzkoušení a pokud znáte platformu IDEA tak využijete i spoustu pluginů, které jsou pro IntelliJ IDEA a Rubymine.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/02/vytvareni-vyvojoveho-virtualniho-prostredi-s-pomoci-virtualboxu-a-vagrantu/">Vytváření vývojového Virtuálního prostředí pomocí VirtualBoxu a Vagrantu</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-02-02T00:00:00+01:00" pubdate data-updated="true">02. 02. 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://www.virtualbox.org/">Oracle VirtualBox</a> je známé virtualizační prostředí pro platformy linux, mac a windows. Já VirtualBox používám na linux, mám na něm Ubuntu, které používám na školení Subversion nebo na vývoj webových aplikací jako server. Do nedávna jsem to používal na Macu nebo Linux pro běh Windows apod. O tomto používání nechci dnes mluvit.</p>

<p><a href="http://www.vagrantup.com">Vagrant</a> je nástroj napsaný v Ruby, který nám umožňuje modifikovat virtualní stroj podle našich představ pomocí nějakého předpisu, který nám udělá co chceme. Ukážeme si to na příkladu, že připravím linuxový server pro webový vývoj s Apache, PHP5, MySQL, CouchDB.</p>

<p>Začneme instalací Vagrantu</p>

<pre class="code">sudo gem install vagrant
vagrant box add base http://files.vagrantup.com/lucid32.box</pre>


<p>Vytvoříme si ukázkový projekt.</p>

<pre class="code">mkdir vagrant-lamp
cd vagrant-lamp
vagrant init</pre>


<p>Musíme upravit Vagrantfile podle následujícího předpisu (pro Vagrant 0.7).</p>

<pre class="code">Vagrant::Config.run do |config|
  # All Vagrant configuration is done here. For a detailed explanation
  # and listing of configuration options, please view the documentation
  # online.

  # Every Vagrant virtual environment requires a box to build off of.
  config.vm.box = "base"

  config.vm.forward_port("http", 80, 8080)
  config.vm.forward_port("mysql", 3306, 3306)
  config.vm.forward_port("couchdb", 5984, 5984)

  config.vm.provision :chef_solo do |chef|
     chef.cookbooks_path = "cookbooks"
     chef.json.merge!({
        :mysql =&gt; {
            :server_root_password =&gt; "root"
        }
     })
     chef.add_recipe("vagrant_main")
  end

end</pre>


<p>Vytvoříme si adresáře pro recepty a pro web.</p>

<pre class="code">mkdir cookbooks
mkdir public</pre>


<p>Do cookbooks je potřeba nakopírovat recepty pro Chef. Doporučuji si vzít z Githubu celou cookbooks repository.
git clone <a href="https://github.com/opscode/cookbooks.git"><a href="https://github.com/opscode/cookbooks.git">https://github.com/opscode/cookbooks.git</a></a></p>

<p>protože receptů je hodně, doporučuji si to dám někam mimo a nakopírovat jen potřebné recepty. Pro nás jsou to ty, které jsou v úvodu default.rb a některé navíc jako je třeba erlang pro couchdb.</p>

<p>do adresáře cookbooks jsem si nakopíroval tyto recepty z cookbooks repository.</p>

<pre>apache2
apt
couchdb
erlang
git
mysql
openssl
php</pre>


<p>Potom si vytvoříme vlastní recept, který celou akci <a href="http://www.opscode.com/chef">Chefa</a> v Vagrantu bude řídit.</p>

<pre>mkdir -p cookbooks/vagrant_main/recipes
vim default.rb</pre>


<p>Přidáme potřebné recepty</p>

<pre>require_recipe "apt"
require_recipe "apache2"
require_recipe "mysql::server"
require_recipe "php::php5"
require_recipe "git"
require_recipe "couchdb"</pre>


<p>Kromě instalace z receptů provede instalaci některý dalších balíčků v Ubuntu</p>

<pre># Some neat package (subversion is needed for "subversion" chef ressource)
%w{ debconf php5-xdebug subversion mc htop curl }.each do |a_package|
  package a_package
end</pre>


<p>Vytvoříme si testovací vývojový web.</p>

<pre>s = "dev-site"
site = {
  :name =&gt; s,
  :host =&gt; "www.#{s}.com",
  :aliases =&gt; ["#{s}.com", "dev.#{s}-static.com"]
}</pre>


<p>použije se template uložena v vagrant_main/templates/default/sites.conf.erb a příslušné proměnné</p>

<pre># Configure the development site
web_app site[:name] do
  template "sites.conf.erb"
  server_name site[:host]
  server_aliases site[:aliases]
  docroot "/vagrant/public/"
end</pre>


<p>modifikujeme si hosty</p>

<pre># Add site info in /etc/hosts
bash "info_in_etc_hosts" do
  code "echo 127.0.0.1 #{site[:host]} #{site[:aliases]} &gt;&gt; /etc/hosts"
end</pre>


<p>přidáme některé knihovny přímo z repository Subversion</p>

<pre># Retrieve webgrind for xdebug trace analysis
subversion "Webgrind" do
  repository "http://webgrind.googlecode.com/svn/trunk/"
  revision "HEAD"
  destination "/var/www/webgrind"
  action :sync
end</pre>


<p>nebo Git</p>

<pre># Retrieve adminer
git "Adminer" do
  repository "https://github.com/vrana/adminer.git"
  revision "HEAD"
  destination "/var/www/adminer/"
  action :sync
end</pre>


<p>a další</p>

<pre># Latest Zend Framework version
subversion "Zend" do
  # repository "http://framework.zend.com/svn/framework/standard/trunk/library/"
  repository "http://framework.zend.com/svn/framework/standard/tags/release-1.11.3/library/"
  revision "HEAD"
  destination "/srv/lib/php/"
  action :sync
end</pre>


<p>Potom je tu script, kterým se dá modifikovat práva pro MySQL, není problém si podobně udělat jakékoliv úpravy.</p>

<pre># Add an admin user to mysql
execute "add-admin-user" do
  command "/usr/bin/mysql -u root -p#{node[:mysql][:server_root_password]} -e \"" +
      "CREATE USER 'myadmin'@'localhost' IDENTIFIED BY 'myadmin';" +
      "GRANT ALL PRIVILEGES ON *.* TO 'myadmin'@'localhost' WITH GRANT OPTION;" +
      "CREATE USER 'myadmin'@'%' IDENTIFIED BY 'myadmin';" +
      "GRANT ALL PRIVILEGES ON *.* TO 'myadmin'@'%' WITH GRANT OPTION;\" " +
      "mysql"
  action :run
  ignore_failure true
end</pre>


<p>pro funkční port forwarding u CouchDb modifikovat konfiguraci a potřeba dát po prvním spuštění dát vargant reload aby se tato poslední změna promítla do nastavení virtuálu.</p>

<pre># Replace 127.0.0.1 bind port with 0.0.0.0 is necessary for port forwarding
execute "port-forward-couchdb" do
  command "sudo sed -i 's/127.0.0.1/0.0.0.0/g' /etc/couchdb/default.ini"
  action :run
end</pre>


<p>První spuštění pomocí</p>

<pre>vagrant up</pre>


<p>potom je potřeba pro CouchDb</p>

<pre>vagrant reload</pre>


<p>Kompletní repositář s tímto ukázkovým prostředím jsou dostupné na <a href="https://github.com/abtris/vagrant-lamp">Githubu</a>.</p>

<p>Pokud si rozbijete virtuál tak není problém začít znovu. Dáte <code>vagrant destroy</code> a potom znovu pustíte celý proces pomocí <code>vagrant up</code>.</p>

<p>Pokud se chcete přihlásit na virtuál použijte <code>vagrant ssh</code>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/01/zend-framework-a-nosql-pro-ukladani-logu-ve-webovych-aplikaci-druhy-dil-o-mongodb/">Zend Framework a NoSQL pro ukládání logů ve webových aplikací, díl druhý o MongoDb</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-01-28T00:00:00+01:00" pubdate data-updated="true">28. 01. 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Jak už jsem psal v <a href="http://blog.prskavec.net/2010/08/zend-framework-a-nosql-pro-ukladani-logu-ve-webovych-aplikaci-dil-1-couchdb/">minulém díle o CouchDb</a> není žádný problém v použití dokumentových databází na logy. Výhodou je že se nemusíte starat o schema, což se u aplikace tohoto druhu opravdu hodí.</p>

<p>Pro napojení Zend Frameworku na logování do MongoDb musíte mít nainstalovanou MongoDb extenzi do PHP. Bez ní se bohužel neobejdete. Log writer si vytvoříte snadno pomocí extenze Zend_Log_Writer_Abstract a provedete drobné úpravy pro práci s MongoDb jak obsahuje ukázka.</p>

<pre class="code php">
/** Zend_Log_Writer_Abstract */
require_once 'Zend/Log/Writer/Abstract.php'; 
/**
 * ZendLogWriterCouchDb
 * @throws Zend_Log_Exception
 */
class App_Log_Writer_MongoDb extends Zend_Log_Writer_Abstract
{
    /**
     * Db
     * @var Mongo
     */
    private $_db;
    /**
     * Db name
     * @var string
     */
    private $_dbname;
    /**
     * Collection
     * @var string
     */
    private $_collection;
    /**
     *
     * @param array $params
     * @return void
     */
    public function __construct($options)
    {
        if (!extension_loaded('mongo')) {
            throw new Exception('The MongoDB extension must be loaded for using this logger !');
        }

        $options = $options->toArray();
        if (is_null($options)) {
            $options['host'] = "localhost";
            $options['port'] = "27017";
            $options['db'] = $dbname;
        }
        if (isset($options['user']) && isset($options['pass'])) {
            $conn = "{$options['user']}:{$options['pass']}@";
        } else {
            $conn = "";
        }
        $this->_db = new Mongo("mongodb://$conn{$options['host']}:{$options['port']}/{$options['db']}");
        $this->_dbname = $options['db'];
        $this->_collection = $options['collection'];
    }
    /**
     * @static
     * @param  $config
     * @return
     */
    static public function factory($config)                                                                                                                 
    {
        $config = self::_parseConfig($config);
        return $config;
    }
    /**
     * @param array $event
     * @return void
     */
    protected function _write($event)
    {
        $m = $this->_db;
        $m->connect();
        $c = $m->selectCollection($this->_dbname, $this->_collection);
        $c->insert($event);
    }

    
}
</pre>


<p>a tímto jste vlastně hotovy. Celý kód najdete na <a href='https://github.com/abtris/phplogger-mongodb'>githubu</a>. V ukázce je ještě samozřejmě upravený controller pro zobrazování a obsahuje možnost vytvářet testovací data.</p>

<p>MongoDb můžete nainstalovat lokálně nebo použít hosting <a href='http://mongohq.com'>mongohq.com</a>, kde základní databáze, která k testování stačí je zdarma. Potom se mi docela hodila utilita na Macu <a href="http://mongohub.todayclose.com/">Mongohub</a>, která poskytuje trochu konfortnější konzoli než webová konzole obsahující lokální instalaci. Na hostingu MongoHQ mají pěknou webovou administrační konzoli.</p>

<p>V PHP se kromě vlastní extenze dá ještě dobře použít pro Zend Framework knihovna <a href="https://github.com/coen-hyde/Shanty-Mongo">Shanty Mongo</a>, která zjednodušuje práci s Mongo Db na maximum.</p>

<p>Pokud budete chtít dělat složitější dotazy do MongoDb hodí se
<a href="http://www.mongodb.org/display/DOCS/SQL+to+Mongo+Mapping+Chart">SQL to Mongo Mapping Chart</a>.</p>

<p>Případné další tipy se nebojte napsat do komentářů.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/12/krest-knihy-1001-tipu-a-triku-pro-php/">Křest knihy 1001 tipů a triků pro PHP</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-12-23T00:00:00+01:00" pubdate data-updated="true">23. 12. 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Včera se konal křest knihy 1001 tipů a triků pro PHP Jakuba Vrány, prostředí Lokády v Praze Holešovicích bylo pekně vybráno. Jako ostatní jsem přišel podpořit Jakuba a koupit si jeho knihu s podpisem. Jirka Kosek se ujal role patrona knihy a pokřtil ji šampaňským jak se patří.</p>

<p>Zlatým hřebem večera byla dražba 1 výtisku knihy, který Jakub vlastnoručně vytiskl a měl první návrh obálky a autorovy poznámku. Tento výtisk vydražili po dramatickém boji zástupci skype.</p>

<br />


<p><code><a href="http://twitter.com/spazef0rze/statuses/17736007466094592">@spazef0rze</a> Tak jsme společně s @<a rel="nofollow" href="http://twitter.com/lukashudecek">lukashudecek</a> vydražili první výtisk knihy od @<a rel="nofollow" href="http://twitter.com/jakubvrana">jakubvrana</a> <a title="#php1001" rel="nofollow" href="http://twitter.com/search?q=%23php1001">#php1001</a> za 6100 pro Paraple. K vidění bude ve Skype office.</code></p>

<br />


<p>Druhý výtisk byla verze s komentáři Davida Grudla a jeho korekturami. Tento výtisk byl opatřen polibky hlavních aktérů jak můžete vidět na videu Martina Hassmana.</p>

<p>Celková cena se vyšplhala na 10010 Kč. Celkový průběh dramatické držby jsem se snažil <a href="http://twitter.com/#search?q=php1001">twittrovat</a>, ale nebylo sto zachytit všechny příhozy.</p>

<p>Celkový výtěžek dražby Jakub věnuje <a href="http://www.paraple.cz/">kontu Paraple</a>, taktéž část z nákupu knih při autogramiádě (3 Kč z každého prodaného výtisku).</p>

<p>Knihu jsem zběžně prohlédl a vidím v ní velký potenciál. Kniha je vhodná pro všechny PHP programátory, od začínajících, kterým může složit jako dobrý návod na to co zrovna řeší. Jednotlivé tipy jsou stručné, výstižné a jdou přímo k věci. Zkušenější programátoři asi nenajdou nic objevného, ale pár tipů vás jistě jako mne zaujme také.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/page//page/6/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/page//page/4/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <ul id="recent_posts">
      <li class="post">
      <a href="http://blog.prskavec.net" alt="Home"><img class="icons" src="/images/Home.png" ></a>
      <a href="http://blog.prskavec.net/archives/" alt="Archives"><img  class="icons" src="/images/Calendar.png"></a>
      <a href="mailto:ladislav@prskavec.net" alt="E-Mail"><img  class="icons" src="/images/Envelope.png"></a>
      <a href="http://blog.prskavec.net/atom.xml" alt="subscribe feed"><img class="icons" src="/images/rss_big.png"></a>
      </li>
  </ul>
</section>
<section>
  <h1>Ladislav Prskavec</h1>
  <p style="margin-top:6px;"><img src="/images/avatar.jpg" style="float:left; margin-right:10px;" width="100" height="115" /><a href="http://github.com/abtris/">Programátor</a>, otec, <a href="http://www.dzogchen.cz">buddhista</a>, milovník dobrého jídla, knih, nových technologí a hraček pro všechny s&nbsp;duší dítěte.
</p>
  <br style="clear:left;"/>
</section>
<section>
  <h1>Poslední příspěvky</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2016/12/jenkins-declarative-pipelines/">Jenkins Declarative Pipelines</a>
      </li>
    
      <li class="post">
        <a href="/2016/10/jenkins-2-dot-0-novinky-a-vylepseni-2-dot-cast/">Jenkins 2.0 - novinky a vylepšení - 2.část</a>
      </li>
    
      <li class="post">
        <a href="/2016/10/jenkins-2-dot-0-novinky-a-vylepseni/">Jenkins 2.0 - novinky a vylepšení</a>
      </li>
    
      <li class="post">
        <a href="/2016/10/prednaska-o-sre-na-devops-meetupu/">Přednáška o SRE na DevOPS meetupu</a>
      </li>
    
      <li class="post">
        <a href="/2016/07/srecon-16-europe/">SREcon&#8217;16 Europe</a>
      </li>
    
      <li class="post">
        <a href="/2016/06/serverless-jako-neco-vic-nez-docker/">Serverless jako něco víc než Docker</a>
      </li>
    
      <li class="post">
        <a href="/2016/03/co-to-je-sre/">Co to je SRE?</a>
      </li>
    
      <li class="post">
        <a href="/2016/02/suchy-docker/">Suchý docker</a>
      </li>
    
      <li class="post">
        <a href="/2015/12/nastroje-co-pouzivam-pro-vyvoj-a-spravu/">Nástroje co používám pro vývoj a správu</a>
      </li>
    
      <li class="post">
        <a href="/2015/09/porovnani-implementace-microservice-v-nodejs-and-go-lang/">Porovnání implementace service v NodeJS a Go lang</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Knihy</h1>
  <p style="margin-top:6px; text-align:center"><a href="http://itunes.apple.com/cz/book/subversion/id498008712?mt=11" onClick="_gaq.push(['_trackEvent', 'link', 'itunes/subversion', 'svn-promo-sidebar-vpravo']);"><img src="http://a2.mzstatic.com/eu/r30/Publication/v4/eb/a3/38/eba33827-f23c-dc3d-d108-7ac062957177/cover225x225.jpeg" style="float:left; margin-right:10px; width:172px; height:225px;" /></a>
</p>
  <br style="clear:left;"/>
</section>

<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/+LadislavPrskavec?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>


<section>
  <h1>GitHub</h1>

<iframe src="http://githubbadge.appspot.com/badge/abtris" style="border: 0;height: 142px;width: 200px;overflow: hidden;" frameBorder=0></iframe>

</section>
<section>
  <h1>Twitter</h1>
  <a class="twitter-timeline" width="250" height="500" href="https://twitter.com/abtris" data-widget-id="345276838232326144">Tweets by @abtris</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Ladislav Prskavec -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-79221-21']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script>
var _0x5d8e=["readyState","complete","name","get","getAll","gtm","indexOf",".send","event","send","social","body","getElementsByTagName","undefined","copy","Advanced tracking","Copy to clipboard","substring","trim","textContent","target","addEventListener","onscroll","document","documentElement","scrollHeight","offsetHeight","clientHeight","max","innerHeight","scrollTop","pageYOffset","Scroll","20%","40%","60%","80%","100%","pathname","location","[\\?&#]","=([^&#]*)","exec","edge.create","Facebook","Like","subscribe","Event","edge.remove","Unlike","message.send","Share","nodeName","IFRAME","src","url","Twitter","tweet","bind","events","ready","Time spent","15s","setTimeout","30s","45s","60s","75s","90s","105s","120s","length","","replace","round","img","Text length","Image count"];(function(){try{if(document[_0x5d8e[0]]===_0x5d8e[1]){mainAdvancedTracking()}else {var interval=setInterval(function(){if(document[_0x5d8e[0]]===_0x5d8e[1]){clearInterval(interval);mainAdvancedTracking()}},250)};function mainAdvancedTracking(){

        var copyToClipboard = true;
        var scrollTracking = true;
        var textLength = true;
        var imageCount = true;
        var socialTracking = true;
        var timeSpent = true;

var trackerName=ga[_0x5d8e[4]]()[0][_0x5d8e[3]](_0x5d8e[2]);var isGTMhere=false;if(trackerName[_0x5d8e[6]](_0x5d8e[5])> -1){isGTMhere=true};function sentEventToGA(eCat,eAct,eLab){if(isGTMhere){ga(trackerName+_0x5d8e[7],_0x5d8e[8],{eventCategory:eCat,eventAction:eAct,eventLabel:eLab,nonInteraction:1})}else {ga(_0x5d8e[9],_0x5d8e[8],eCat,eAct,eLab,{"nonInteraction":1})}}function sentSocialToGA(eCat,eAct,eLab){if(isGTMhere){ga(trackerName+_0x5d8e[7],_0x5d8e[10],{eventCategory:eCat,eventAction:eAct,eventLabel:eLab})}else {ga(_0x5d8e[9],{hitType:_0x5d8e[10],socialNetwork:eCat,socialAction:eAct,socialTarget:eLab})}}try{if(copyToClipboard){var hbody=document[_0x5d8e[12]](_0x5d8e[11])[0];if( typeof (hbody)!==_0x5d8e[13]){hbody[_0x5d8e[21]](_0x5d8e[14],function(evt){sentEventToGA(_0x5d8e[15],_0x5d8e[16],evt[_0x5d8e[20]][_0x5d8e[19]][_0x5d8e[18]]()[_0x5d8e[17]](0,100))})}}}catch(err){};try{if(scrollTracking){var flag20=true;var flag40=true;var flag60=true;var flag80=true;var flag100=true;window[_0x5d8e[22]]=function(e){var body=window[_0x5d8e[23]][_0x5d8e[11]],html=window[_0x5d8e[23]][_0x5d8e[24]];var delkaStranky=Math[_0x5d8e[28]](body[_0x5d8e[25]],body[_0x5d8e[26]],html[_0x5d8e[27]],html[_0x5d8e[25]],html[_0x5d8e[26]]);var velikostOkna=window[_0x5d8e[29]]||document[_0x5d8e[24]][_0x5d8e[27]]||document[_0x5d8e[11]][_0x5d8e[27]];var pozice=(window[_0x5d8e[23]][_0x5d8e[30]]||window[_0x5d8e[31]])+velikostOkna;if(pozice>0){var procenta=(pozice/delkaStranky)*100};if((flag20)&&(procenta>20)){sentEventToGA(_0x5d8e[15],_0x5d8e[32],_0x5d8e[33]);flag20=false};if((flag40)&&(procenta>40)){sentEventToGA(_0x5d8e[15],_0x5d8e[32],_0x5d8e[34]);flag40=false};if((flag60)&&(procenta>60)){sentEventToGA(_0x5d8e[15],_0x5d8e[32],_0x5d8e[35]);flag60=false};if((flag80)&&(procenta>80)){sentEventToGA(_0x5d8e[15],_0x5d8e[32],_0x5d8e[36]);flag80=false};if((flag100)&&(procenta>99)){sentEventToGA(_0x5d8e[15],_0x5d8e[32],_0x5d8e[37]);flag100=false}}}}catch(err){};try{if(socialTracking){var mpath=document[_0x5d8e[39]][_0x5d8e[38]];function extractParamFromUri(uri,paramName){if(!uri){return};var regex= new RegExp(_0x5d8e[40]+paramName+_0x5d8e[41]);var params=regex[_0x5d8e[42]](uri);if(params!=null){return unescape(params[1])};return}FB[_0x5d8e[47]][_0x5d8e[46]](_0x5d8e[43],function(targetUrl){sentSocialToGA(_0x5d8e[44],_0x5d8e[45],mpath)});FB[_0x5d8e[47]][_0x5d8e[46]](_0x5d8e[48],function(targetUrl){sentSocialToGA(_0x5d8e[44],_0x5d8e[49],mpath)});FB[_0x5d8e[47]][_0x5d8e[46]](_0x5d8e[50],function(targetUrl){sentSocialToGA(_0x5d8e[44],_0x5d8e[51],mpath)});function trackTwitter(intent_event){if(intent_event){var opt_pagePath;if(intent_event[_0x5d8e[20]]&&intent_event[_0x5d8e[20]][_0x5d8e[52]]==_0x5d8e[53]){opt_target=extractParamFromUri(intent_event[_0x5d8e[20]][_0x5d8e[54]],_0x5d8e[55])};sentEventToGA(_0x5d8e[56],_0x5d8e[51],mpath)}}twttr[_0x5d8e[60]](function(twttr){twttr[_0x5d8e[59]][_0x5d8e[58]](_0x5d8e[57],trackTwitter)})}}catch(err){};try{if(timeSpent){window[_0x5d8e[63]](function(){sentEventToGA(_0x5d8e[15],_0x5d8e[61],_0x5d8e[62])},15000);window[_0x5d8e[63]](function(){sentEventToGA(_0x5d8e[15],_0x5d8e[61],_0x5d8e[64])},30000);window[_0x5d8e[63]](function(){sentEventToGA(_0x5d8e[15],_0x5d8e[61],_0x5d8e[65])},45000);window[_0x5d8e[63]](function(){sentEventToGA(_0x5d8e[15],_0x5d8e[61],_0x5d8e[66])},60000);window[_0x5d8e[63]](function(){sentEventToGA(_0x5d8e[15],_0x5d8e[61],_0x5d8e[67])},75000);window[_0x5d8e[63]](function(){sentEventToGA(_0x5d8e[15],_0x5d8e[61],_0x5d8e[68])},90000);window[_0x5d8e[63]](function(){sentEventToGA(_0x5d8e[15],_0x5d8e[61],_0x5d8e[69])},105000);window[_0x5d8e[63]](function(){sentEventToGA(_0x5d8e[15],_0x5d8e[61],_0x5d8e[70])},120000)}}catch(err){};try{var tLen=document[_0x5d8e[12]](_0x5d8e[11])[0][_0x5d8e[19]][_0x5d8e[18]]()[_0x5d8e[73]](/ /g,_0x5d8e[72])[_0x5d8e[73]](/(?:\r\n|\r|\n)/g,_0x5d8e[72])[_0x5d8e[71]];tLen=Math[_0x5d8e[74]](tLen/100)*100;var imgLen=document[_0x5d8e[12]](_0x5d8e[75])[_0x5d8e[71]];if(textLength){sentEventToGA(_0x5d8e[15],_0x5d8e[76],tLen)};if(imageCount){sentEventToGA(_0x5d8e[15],_0x5d8e[77],imgLen)}}catch(err){}}}catch(err){}})()
</script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
(function (d, w, c) {
    (w[c] = w[c] || []).push(function() {
        try {
            w.yaCounter21617953 = new Ya.Metrika({id:21617953,
                    webvisor:true,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true});
        } catch(e) { }
    });

    var n = d.getElementsByTagName("script")[0],
        s = d.createElement("script"),
        f = function () { n.parentNode.insertBefore(s, n); };
    s.type = "text/javascript";
    s.async = true;
    s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";

    if (w.opera == "[object Opera]") {
        d.addEventListener("DOMContentLoaded", f, false);
    } else { f(); }
})(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="//mc.yandex.ru/watch/21617953" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->



<script type="text/javascript">
      var disqus_shortname = 'prskavecblog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


<script src="/javascripts/all.js?v=1412111651"></script>



</body>
</html>
